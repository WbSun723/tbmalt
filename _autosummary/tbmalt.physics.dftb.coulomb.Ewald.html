

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2.1.5.1.4.2. Ewald &mdash; TBMaLT 0.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=7026087e"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.1.5.1.4.3. Ewald1d" href="tbmalt.physics.dftb.coulomb.Ewald1d.html" />
    <link rel="prev" title="2.1.5.1.4.1. build_coulomb_matrix" href="tbmalt.physics.dftb.coulomb.build_coulomb_matrix.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            TBMaLT
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../usage.html">1. Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../documentation.html">2. Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="tbmalt.html">2.1. tbmalt</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="tbmalt.common.html">2.1.1. common</a></li>
<li class="toctree-l3"><a class="reference internal" href="tbmalt.data.html">2.1.2. data</a></li>
<li class="toctree-l3"><a class="reference internal" href="tbmalt.io.html">2.1.3. io</a></li>
<li class="toctree-l3"><a class="reference internal" href="tbmalt.ml.html">2.1.4. ml</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="tbmalt.physics.html">2.1.5. physics</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="tbmalt.physics.dftb.html">2.1.5.1. dftb</a></li>
<li class="toctree-l4"><a class="reference internal" href="tbmalt.physics.filling.html">2.1.5.2. filling</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tbmalt.structures.html">2.1.6. structures</a></li>
<li class="toctree-l3"><a class="reference internal" href="tbmalt.tools.html">2.1.7. tools</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">3. Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development.html">4. Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide.html">5. Development Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">6. Release notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">TBMaLT</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../documentation.html"><span class="section-number">2. </span>Documentation</a></li>
          <li class="breadcrumb-item"><a href="tbmalt.html"><span class="section-number">2.1. </span>tbmalt</a></li>
          <li class="breadcrumb-item"><a href="tbmalt.physics.html"><span class="section-number">2.1.5. </span>physics</a></li>
          <li class="breadcrumb-item"><a href="tbmalt.physics.dftb.html"><span class="section-number">2.1.5.1. </span>dftb</a></li>
          <li class="breadcrumb-item"><a href="tbmalt.physics.dftb.coulomb.html"><span class="section-number">2.1.5.1.4. </span>coulomb</a></li>
      <li class="breadcrumb-item active"><span class="section-number">2.1.5.1.4.2. </span>Ewald</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_autosummary/tbmalt.physics.dftb.coulomb.Ewald.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="ewald">
<h1><span class="section-number">2.1.5.1.4.2. </span>Ewald<a class="headerlink" href="#ewald" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="tbmalt.physics.dftb.coulomb.Ewald">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Ewald</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tbmalt/physics/dftb/coulomb.html#Ewald"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tbmalt.physics.dftb.coulomb.Ewald" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>ABC for calculating the coulombic interaction in periodic geometry.</p>
<p><cite>Ewald</cite> class calculates the long range coulombic interaction using Ewald
summation, which consists of three different parts, i.e. two rapidly
converging terms (real space sum, reciprocal space sum) and a
self-correction term. Formulas for different periodic boundary conditions
are given in the corresponding references.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geometry</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="tbmalt.structures.geometry.Geometry.html#tbmalt.structures.geometry.Geometry" title="tbmalt.structures.geometry.Geometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geometry</span></code></a></span>) – Object for calculation, storing the data of input geometry.</p></li>
<li><p><strong>periodic</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="tbmalt.structures.periodicity.Triclinic.html#tbmalt.structures.periodicity.Triclinic" title="tbmalt.structures.periodicity.Triclinic"><code class="xref py py-class docutils literal notranslate"><span class="pre">Triclinic</span></code></a></span>) – Object for calculation, storing the data of translation
vectors and neighbour list for periodic boundary condition.</p></li>
<li><p><strong>param</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>) – Parameter used for calculation. Cell volume for 3D pbc,
cell length for 1D &amp; 2D pbc.</p></li>
</ul>
</dd>
<dt class="field-even">Keyword Arguments<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>tol_ewald</strong> – Tolerance of Ewald summation.</p></li>
<li><p><strong>method</strong> – Method to obtain parameters of alpha, maxr and maxg.</p></li>
<li><p><strong>nsearchiter</strong> – Maximum of iteration for searching alpha, maxg and maxr.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="tbmalt.physics.dftb.coulomb.Ewald.geometry">
<span class="sig-name descname"><span class="pre">geometry</span></span><a class="headerlink" href="#tbmalt.physics.dftb.coulomb.Ewald.geometry" title="Link to this definition"></a></dt>
<dd><p>Object for calculation, storing the data of input geometry.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tbmalt.physics.dftb.coulomb.Ewald.periodic">
<span class="sig-name descname"><span class="pre">periodic</span></span><a class="headerlink" href="#tbmalt.physics.dftb.coulomb.Ewald.periodic" title="Link to this definition"></a></dt>
<dd><p>Object for calculation, storing the data of translation
vectors and neighbour list for periodic boundary condition.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tbmalt.physics.dftb.coulomb.Ewald.latvec">
<span class="sig-name descname"><span class="pre">latvec</span></span><a class="headerlink" href="#tbmalt.physics.dftb.coulomb.Ewald.latvec" title="Link to this definition"></a></dt>
<dd><p>Lattice vectors of the periodic systems.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tbmalt.physics.dftb.coulomb.Ewald.n_atoms">
<span class="sig-name descname"><span class="pre">n_atoms</span></span><a class="headerlink" href="#tbmalt.physics.dftb.coulomb.Ewald.n_atoms" title="Link to this definition"></a></dt>
<dd><p>Number of atoms in the system.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tbmalt.physics.dftb.coulomb.Ewald.coord">
<span class="sig-name descname"><span class="pre">coord</span></span><a class="headerlink" href="#tbmalt.physics.dftb.coulomb.Ewald.coord" title="Link to this definition"></a></dt>
<dd><p>Coordinates of the atoms.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tbmalt.physics.dftb.coulomb.Ewald.recvec">
<span class="sig-name descname"><span class="pre">recvec</span></span><a class="headerlink" href="#tbmalt.physics.dftb.coulomb.Ewald.recvec" title="Link to this definition"></a></dt>
<dd><p>Reciprocal lattice vectors.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tbmalt.physics.dftb.coulomb.Ewald.param">
<span class="sig-name descname"><span class="pre">param</span></span><a class="headerlink" href="#tbmalt.physics.dftb.coulomb.Ewald.param" title="Link to this definition"></a></dt>
<dd><p>Parameter used for calculation. Cell volume for 3D pbc,
cell length for 1D &amp; 2D pbc.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tbmalt.physics.dftb.coulomb.Ewald.tol_ewald">
<span class="sig-name descname"><span class="pre">tol_ewald</span></span><a class="headerlink" href="#tbmalt.physics.dftb.coulomb.Ewald.tol_ewald" title="Link to this definition"></a></dt>
<dd><p>Tolerance of Ewald summation.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tbmalt.physics.dftb.coulomb.Ewald.method">
<span class="sig-name descname"><span class="pre">method</span></span><a class="headerlink" href="#tbmalt.physics.dftb.coulomb.Ewald.method" title="Link to this definition"></a></dt>
<dd><p>Method to obtain parameters of alpha, maxr and maxg.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tbmalt.physics.dftb.coulomb.Ewald.nsearchiter">
<span class="sig-name descname"><span class="pre">nsearchiter</span></span><a class="headerlink" href="#tbmalt.physics.dftb.coulomb.Ewald.nsearchiter" title="Link to this definition"></a></dt>
<dd><p>Maximum of iteration for searching alpha, maxg and maxr.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tbmalt.physics.dftb.coulomb.Ewald.alpha">
<span class="sig-name descname"><span class="pre">alpha</span></span><a class="headerlink" href="#tbmalt.physics.dftb.coulomb.Ewald.alpha" title="Link to this definition"></a></dt>
<dd><p>Splitting parameter for the Ewald summation</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tbmalt.physics.dftb.coulomb.Ewald.maxr">
<span class="sig-name descname"><span class="pre">maxr</span></span><a class="headerlink" href="#tbmalt.physics.dftb.coulomb.Ewald.maxr" title="Link to this definition"></a></dt>
<dd><p>The longest real space vector that gives a bigger
contribution to the EWald sum than tolerance.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tbmalt.physics.dftb.coulomb.Ewald.maxg">
<span class="sig-name descname"><span class="pre">maxg</span></span><a class="headerlink" href="#tbmalt.physics.dftb.coulomb.Ewald.maxg" title="Link to this definition"></a></dt>
<dd><p>The longest reciprocal vector that gives a bigger
contribution to the EWald sum than tolerance.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tbmalt.physics.dftb.coulomb.Ewald.rcellvec_ud">
<span class="sig-name descname"><span class="pre">rcellvec_ud</span></span><a class="headerlink" href="#tbmalt.physics.dftb.coulomb.Ewald.rcellvec_ud" title="Link to this definition"></a></dt>
<dd><p>Cell translation vectors in absolute units.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tbmalt.physics.dftb.coulomb.Ewald.ncell_ud">
<span class="sig-name descname"><span class="pre">ncell_ud</span></span><a class="headerlink" href="#tbmalt.physics.dftb.coulomb.Ewald.ncell_ud" title="Link to this definition"></a></dt>
<dd><p>Number of lattice cells.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tbmalt.physics.dftb.coulomb.Ewald.distmat">
<span class="sig-name descname"><span class="pre">distmat</span></span><a class="headerlink" href="#tbmalt.physics.dftb.coulomb.Ewald.distmat" title="Link to this definition"></a></dt>
<dd><p>Periodic distances.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tbmalt.physics.dftb.coulomb.Ewald.neighbour">
<span class="sig-name descname"><span class="pre">neighbour</span></span><a class="headerlink" href="#tbmalt.physics.dftb.coulomb.Ewald.neighbour" title="Link to this definition"></a></dt>
<dd><p>A mask to choose atoms of images inside the cutoff.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tbmalt.physics.dftb.coulomb.Ewald.ewald_r">
<span class="sig-name descname"><span class="pre">ewald_r</span></span><a class="headerlink" href="#tbmalt.physics.dftb.coulomb.Ewald.ewald_r" title="Link to this definition"></a></dt>
<dd><p>Real part of the Ewald summation.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tbmalt.physics.dftb.coulomb.Ewald.mask_g">
<span class="sig-name descname"><span class="pre">mask_g</span></span><a class="headerlink" href="#tbmalt.physics.dftb.coulomb.Ewald.mask_g" title="Link to this definition"></a></dt>
<dd><p>Mask used for calculation of reciprocal part.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tbmalt.physics.dftb.coulomb.Ewald.ewald_g">
<span class="sig-name descname"><span class="pre">ewald_g</span></span><a class="headerlink" href="#tbmalt.physics.dftb.coulomb.Ewald.ewald_g" title="Link to this definition"></a></dt>
<dd><p>Reciprocal part of the Ewald summation</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tbmalt.physics.dftb.coulomb.Ewald.invrmat">
<span class="sig-name descname"><span class="pre">invrmat</span></span><a class="headerlink" href="#tbmalt.physics.dftb.coulomb.Ewald.invrmat" title="Link to this definition"></a></dt>
<dd><p>1/R matrix for the periodic geometry.</p>
</dd></dl>

<p class="rubric">Notes</p>
<p>There are two available methods to generate adjustable parameters for
Ewald summation. The default method uses empirical formulas from
experience to obtain alpha, maxr and maxg. While these parameters can
also be obtained by searching, which give exactly the same results in
DFTB+ for 3D pbc.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The result of 1D ewald summation is sensitive to the selection of
splitting parameter alpha. Using the default method rather than
searching can achieve the convergence. Besides, mixing of different pbc
is not supported.</p>
</div>
<p class="rubric">References</p>
<p>[1]: Journal of Computational Physics 285 (2015): 280-315.
[2]: The Journal of chemical physics 136.16 (2012): 164111.
[3]: Advances in Computational Mathematics 42.1 (2016): 227-248.
[4]: Chemical physics letters 340.1-2 (2001): 157-164.</p>
<p class="rubric">Methods</p>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tbmalt.physics.dftb.coulomb.build_coulomb_matrix.html" class="btn btn-neutral float-left" title="2.1.5.1.4.1. build_coulomb_matrix" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tbmalt.physics.dftb.coulomb.Ewald1d.html" class="btn btn-neutral float-right" title="2.1.5.1.4.3. Ewald1d" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, TBMaLT.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>